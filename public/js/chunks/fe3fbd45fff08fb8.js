"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[70],{71628:(t,s,e)=>{e.d(s,{Z:()=>o});var i=e(1519),n=e.n(i)()((function(t){return t[1]}));n.push([t.id,".chat-wrapper{background-color:var(--light-theme-panel-bg-color);bottom:0;display:flex;flex-direction:column;left:0;position:absolute;right:0;top:0}.chat-header{align-items:center;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);display:flex;padding:.4em 1em}.chat-header .back{margin-right:1rem;width:.8em}.chat-header .dots{justify-self:flex-end}.chat-header .friend-name{flex-grow:2;max-width:100%}.chat-header .friend-cover{margin-right:.5em}.chat-header .friend-cover img{border-radius:50%;width:2em}.chat-body{flex-grow:5;overflow-y:auto;padding:.4em 1em}.chat-footer{padding:0 1rem .5em}.chat-footer form{position:relative}.chat-footer form .chat-input{height:2.25em;position:relative;width:100%}.chat-footer form .chat-input .error{bottom:0;left:0;opacity:.95;position:absolute;right:0;top:0;z-index:5}.chat-footer form .chat-input input{background-color:#e9e9e9;border-radius:5px;color:#000;padding:.4em 1rem;width:100%}.chat-footer form .send-icon{position:absolute;right:.6em;top:50%;transform:translateY(-50%);z-index:4}.msg{margin:1em 0;position:relative;word-break:break-word}.msg .msg-time{font-size:.6em;margin-bottom:1.3em;text-align:center}.msg .seen{font-size:.85em;left:5%;opacity:.65;position:absolute;top:105%}.msg-text{background-color:#a7a7a7;border-radius:17px;color:#fff;display:flex;padding:.3em .8em;width:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.msg-text .text{align-self:flex-start}.my-msg{text-align:right}.my-msg .seen{left:90%}.my-msg .msg-text{background-color:var(--color-primary);color:#fff;margin-left:auto}.my-msg .msg-text .text{align-self:flex-end}.player--dark .chat-wrapper{background-color:var(--dark-theme-panel-bg-color)}",""]);const o=n},62070:(t,s,e)=>{e.r(s),e.d(s,{default:()=>p});var i=e(53489),n=e(85893),o=e(5255),a=e(97832),r=e(4786),c=e(72545),l=e(3347),d=e(31986);const h={props:["friend"],data:function(){return{chats:[],message:null,isTyping:!1,chatMenuDialog:!1,blockFriendConfirmationDialog:!1}},computed:{session:function(){return this.friend.session}},methods:{send:function(){this.message&&(this.pushToChats(this.message),axios.post("/api/send/".concat(this.friend.session.id),{content:this.message,to_user:this.friend.id}),this.friend.session.last_message[0]||(this.friend.session.last_message[0]={}),this.$store.getters.getSettings.ga4&&this.$store.getters.getSettings.analytics_fileUpload_event&&emitAnalyticsEvent({action:"Chat Message",category:"message",label:this.message}),this.friend.session.last_message[0].content=this.$t("You")+": "+this.message,this.message=null)},pushToChats:function(t){this.chats.push({message:t,type:0,read_at:null,sent_at:this.$t("Just Now")})},close:function(){this.$emit("close")},clear:function(){var t=this;axios.post("/api/sessions/".concat(this.friend.session.id,"/clear")).then((function(){return t.chats=[]}))},block:function(){this.session.block||(this.session.block=!0,this.session.blocked_by=this.$store.getters.getUser.id,this.chatMenuDialog=!this.chatMenuDialog,axios.post("/api/sessions/".concat(this.friend.session.id,"/block")))},unblock:function(){this.session.blocked_by==this.$store.getters.getUser.id&&(this.session.block=!1,this.session.blocked_by=null,axios.post("/api/sessions/".concat(this.friend.session.id,"/unblock"))),this.chatMenuDialog=!this.chatMenuDialog},getAllMessages:function(){var t=this;axios.post("/api/sessions/".concat(this.friend.session.id,"/chats")).then((function(s){return t.chats=s.data}))},read:function(){axios.post("/api/sessions/".concat(this.friend.session.id,"/read"))}},created:function(){var t=this;this.read(),this.getAllMessages(),window.Echo.private("Chat.".concat(this.friend.session.id)).listen("PrivateChatEvent",(function(s){t.friend.session.open&&t.read(),t.chats.push({message:s.content,type:1,sent_at:t.$t("Just Now")}),t.friend.session.last_message[0].content=s.content})),window.Echo.private("Chat.".concat(this.friend.session.id)).listen("MsgReadEvent",(function(s){return t.chats.forEach((function(t){return t.id==s.chat.id?t.read_at=s.chat.read_at:""}))})),window.Echo.private("Chat.".concat(this.friend.session.id)).listen("BlockEvent",(function(s){return t.session.block=s.blocked,t.session.blocked_by=s.blocked_by})),window.Echo.private("Chat.".concat(this.friend.session.id)).listenForWhisper("typing",(function(s){t.isTyping=!0,setTimeout((function(){t.isTyping=!1}),2e3)}))}};var g=e(93379),m=e.n(g),f=e(71628),u={insert:"head",singleton:!1};m()(f.Z,u);f.Z.locals;const p=(0,e(51900).Z)(h,(function(){var t=this,s=t._self._c;return t.friend?s("div",{staticClass:"chat-wrapper"},[s("div",{staticClass:"chat-header"},[s("div",{staticClass:"back pointer",on:{click:function(s){return s.preventDefault(),t.close.apply(null,arguments)}}},[s(r.Z,[t._v("$vuetify.icons.chevron-left")])],1),t._v(" "),s("div",{staticClass:"friend-cover"},[s("img",{attrs:{src:t.friend.avatar,alt:""}})]),t._v(" "),s("div",{staticClass:"friend-name max-1-lines"},[t._v("\n      "+t._s(t.friend.name)+"\n    ")]),t._v(" "),s("div",{staticClass:"dots"},[s(d.Z,{attrs:{left:"",bottom:"","position-y":125,"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,o=e.attrs;return[s(i.Z,t._g(t._b({attrs:{icon:""}},"v-btn",o,!1),n),[s(r.Z,{attrs:{small:""}},[t._v("$vuetify.icons.dots-horizontal")])],1)]}}],null,!1,4209589308)},[t._v(" "),s(c.Z,{staticClass:"list",class:{"dark-background":t.$vuetify.theme.dark}},[t.session.blocked_by?s(l.Z,{on:{click:t.unblock}},[t._v("\n           "+t._s(t.$t("Unblock"))+"\n        ")]):s(l.Z,{on:{click:t.block}},[t._v("\n           "+t._s(t.$t("Block"))+"\n        ")])],1)],1),t._v(" "),s(a.Z,{attrs:{"max-width":"400"},model:{value:t.blockFriendConfirmationDialog,callback:function(s){t.blockFriendConfirmationDialog=s},expression:"blockFriendConfirmationDialog"}},[s(n.Z,[t._v("\n          "+t._s(t.$t("Are you sure you wanna block"))+" "+t._s(t.friend.name)+" ?\n          "),s(o.h7,[s(i.Z,{attrs:{color:"error",text:""},on:{click:t.block}},[t._v(t._s(t.$t("Block")))]),t._v(" "),s(i.Z,{attrs:{text:""},on:{click:function(s){t.blockFriendConfirmationDialog=!1}}},[t._v(t._s(t.$t("Cancel")))])],1)],1)],1)],1)]),t._v(" "),s("div",{staticClass:"chat-body"},t._l(t.chats,(function(e,i){return s("div",{key:e.id,staticClass:"msg",class:{"my-msg":0==e.type}},[s("div",{directives:[{name:"show",rawName:"v-show",value:i==t.chats.length-1,expression:"i == chats.length - 1"}],staticClass:"msg-time"},[t._v("\n        "+t._s(e.send_at)+"\n      ")]),t._v(" "),s("div",{staticClass:"msg-text"},[s("div",{staticClass:"text"},[t._v("\n          "+t._s(e.message)+"\n        ")])]),t._v(" "),i==t.chats.length-1?s("div",{directives:[{name:"show",rawName:"v-show",value:e.read_at,expression:"chat.read_at"}],staticClass:"seen"},[t._v("\n        "+t._s(t.$t("Seen"))+"\n      ")]):t._e()])})),0),t._v(" "),s("div",{staticClass:"chat-footer"},[s("form",{on:{submit:function(s){return s.preventDefault(),t.send.apply(null,arguments)}}},[s("div",{staticClass:"chat-input text-center"},[t.session.block?[t.session.blocked_by==t.$store.getters.getUser.id?s(i.Z,{staticClass:"error",attrs:{block:""},on:{click:t.unblock}},[t._v(t._s(t.$t("Unblock")))]):s("span",[t._v(t._s(t.$t("You can no longer chat with this person.")))])]:[s("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"form-control m_input",attrs:{type:"text",placeholder:"Write your message here"},domProps:{value:t.message},on:{input:function(s){s.target.composing||(t.message=s.target.value)}}}),t._v(" "),s("div",{staticClass:"send-icon pointer",on:{click:t.send}},[s("img",{staticClass:"svg-image",attrs:{src:"/svg/send.svg",alt:""}})])]],2)])])]):t._e()}),[],!1,null,null,null).exports}}]);